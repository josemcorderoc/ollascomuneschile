FROM python:3.7-alpine
RUN apk update && apk add postgresql-dev gcc python3-dev musl-dev
RUN pip install kafka_python tweepy psycopg2

WORKDIR /app
COPY tweet_stream.py .

ARG CONSUMER_API_KEY
ARG CONSUMER_API_SECRET_KEY
ARG ACCESS_TOKEN
ARG ACCESS_TOKEN_SECRET

ENV CONSUMER_API_KEY=$CONSUMER_API_KEY
ENV CONSUMER_API_SECRET_KEY=$CONSUMER_API_SECRET_KEY
ENV ACCESS_TOKEN=$ACCESS_TOKEN
ENV ACCESS_TOKEN_SECRET=$ACCESS_TOKEN_SECRET

ENV PYTHONUNBUFFERED 1

ENTRYPOINT ["python", "tweet_stream.py"]